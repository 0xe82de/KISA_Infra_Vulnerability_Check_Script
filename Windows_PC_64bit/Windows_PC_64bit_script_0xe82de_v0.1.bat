@echo off

REM On Windows 10, the script below can be successful without administrator privileges.
REM In other words, it is inappropriate to verify that the batch file was run with administrator privileges.
REM >nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"

REM Use the bcddit command to verify that administrator privileges are executed.
bcdedit
if '%errorlevel%' NEQ '0' (
  echo "Execute Admin Priv"
  goto GetAdmin
) else ( goto GotAdmin )
:GetAdmin
  echo Set UAC = CreateObject^("Shell.Application"^) > "%temp%\getadmin.vbs"
  set params = %*:"=""
  echo UAC.ShellExecute "cmd.exe", "/c %~s0 %params%", "", "runas", 1 >> "%temp%\getadmin.vbs"
  "%temp%\getadmin.vbs"
  del "%temp%\getadmin.vbs"
  exit /B
:GotAdmin

pushd "%CD%"
  CD /D "%~dp0"

setlocal
chcp 949
REM chdir >> set=script

Set "scriptResult=.\%COMPUTERNAME%.txt"

echo ################################################ >> %scriptResult%
echo ##### Windows PC Check script by "0xe82de" ##### >> %scriptResult%
echo ##### Ver. "0.1"                           ##### >> %scriptResult%
echo ################################################ >> %scriptResult%
echo ##### start #################################### >> %scriptResult%
date /t >> %scriptResult%
time /t >> %scriptResult%
echo ################################################ >> %scriptResult%

echo ##### ipconfig /all ############################ >> %scriptResult%
ipconfig /all >> %scriptResult%
echo ################################################ >> %scriptResult%

echo ##### netstat -an ############################## >> %scriptResult%
c:\windows\system32\netstat -an >> %scriptResult%
echo ################################################ >> %scriptResult%

echo ##### systeminfo ############################### >> %scriptResult%
systeminfo >> %scriptResult%
echo ################################################ >> %scriptResult%





echo ################################################ >> %scriptResult%

echo ################################################ >> %scriptResult%
echo ################################################ >> %scriptResult%
echo ################################################ >> %scriptResult%
echo ################################################ >> %scriptResult%